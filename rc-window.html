<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Sailbot RC Control</title>
        <link
            rel="stylesheet"
            href="node_modules/bootstrap/dist/css/bootstrap.min.css"
        />
        <style>
            body {
                background-color: #1e1e2e;
                color: #e0e0e0;
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    Arial, sans-serif;
                padding: 20px;
                user-select: none;
            }

            .rc-container {
                max-width: 800px;
                margin: 0 auto;
            }

            .control-panel {
                background-color: #2d2d3d;
                border: 1px solid #3d3d4d;
                border-radius: 10px;
                padding: 20px;
                margin-bottom: 20px;
            }

            .key-display {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-bottom: 30px;
            }

            .key-group {
                text-align: center;
            }

            .key-button {
                width: 80px;
                height: 80px;
                font-size: 36px;
                font-weight: bold;
                border: 3px solid #555;
                border-radius: 10px;
                background-color: #3a3a4a;
                color: #ccc;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 5px auto;
                transition: all 0.1s;
            }

            .key-button.active {
                background-color: #007bff;
                border-color: #0056b3;
                color: white;
                transform: scale(0.95);
                box-shadow: 0 0 20px rgba(0, 123, 255, 0.6);
            }

            .key-label {
                font-size: 14px;
                color: #888;
                margin-top: 5px;
            }

            .angle-display {
                background-color: #1a1a2a;
                border-radius: 10px;
                padding: 20px;
                margin-bottom: 20px;
            }

            .angle-item {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
            }

            .angle-label {
                font-weight: bold;
                font-size: 18px;
            }

            .angle-value {
                font-family: "Menlo", "Monaco", "Courier New", monospace;
                font-size: 24px;
                color: #4caf50;
            }

            .angle-bar {
                width: 100%;
                height: 30px;
                background-color: #333;
                border-radius: 15px;
                position: relative;
                overflow: hidden;
                margin-top: 5px;
            }

            .angle-bar-fill {
                height: 100%;
                background: linear-gradient(
                    90deg,
                    #f44336 0%,
                    #4caf50 50%,
                    #f44336 100%
                );
                position: absolute;
                transition: all 0.1s;
            }

            .angle-bar-center {
                position: absolute;
                left: 50%;
                top: 0;
                bottom: 0;
                width: 2px;
                background-color: white;
                transform: translateX(-50%);
            }

            .status-panel {
                background-color: #2d2d3d;
                border: 1px solid #3d3d4d;
                border-radius: 10px;
                padding: 20px;
            }

            .status-item {
                display: flex;
                justify-content: space-between;
                margin-bottom: 10px;
            }

            .connection-status {
                display: inline-flex;
                align-items: center;
                gap: 10px;
                padding: 5px 15px;
                border-radius: 20px;
                font-weight: bold;
            }

            .connection-status.connected {
                background-color: #28a745;
                color: white;
            }

            .connection-status.disconnected {
                background-color: #dc3545;
                color: white;
            }

            .instructions {
                background-color: #2a2a3a;
                border: 1px solid #3d3d4d;
                border-radius: 10px;
                padding: 15px;
                margin-top: 20px;
                text-align: center;
            }

            .instructions h4 {
                color: #17a2b8;
                margin-bottom: 15px;
            }

            .queue-indicator {
                display: inline-block;
                width: 12px;
                height: 12px;
                border-radius: 50%;
                background-color: #ffc107;
                margin-left: 10px;
                opacity: 0;
                transition: opacity 0.3s;
            }

            .queue-indicator.active {
                opacity: 1;
                animation: pulse 1s infinite;
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                    opacity: 1;
                }
                50% {
                    transform: scale(1.2);
                    opacity: 0.7;
                }
                100% {
                    transform: scale(1);
                    opacity: 1;
                }
            }

            .send-timer {
                font-family: "Menlo", "Monaco", "Courier New", monospace;
                color: #ffc107;
            }

            .boat-visualization {
                background-color: #2d2d3d;
                border: 1px solid #3d3d4d;
                border-radius: 10px;
                padding: 20px;
            }

            .canvas-container {
                position: relative;
                display: flex;
                justify-content: center;
                align-items: center;
                background-color: #1a1a2a;
                border-radius: 10px;
                padding: 20px;
            }

            #boat-canvas {
                background-color: #232333;
                border-radius: 10px;
                box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
            }

            .wind-info {
                position: absolute;
                top: 10px;
                right: 10px;
                background-color: rgba(42, 42, 58, 0.9);
                padding: 5px 10px;
                border-radius: 5px;
                border: 1px solid #3d3d4d;
            }

            .wind-label {
                color: #888;
                font-weight: bold;
            }

            .wind-value {
                font-family: "Menlo", "Monaco", "Courier New", monospace;
                color: #17a2b8;
                font-weight: bold;
            }

            .interval-input {
                width: 60px;
                padding: 2px 5px;
                background-color: #1a1a2a;
                border: 1px solid #3d3d4d;
                border-radius: 4px;
                color: #e0e0e0;
                font-family: "Menlo", "Monaco", "Courier New", monospace;
                text-align: center;
            }

            .interval-input:focus {
                outline: none;
                border-color: #007bff;
                box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
            }

            .interval-unit {
                color: #888;
                margin-left: 5px;
            }
        </style>
    </head>
    <body>
        <div class="rc-container">
            <h1 class="text-center mb-4">Sailbot RC Control</h1>

            <div class="control-panel">
                <div
                    class="d-flex justify-content-between align-items-center mb-3"
                >
                    <h3>Keyboard Controls</h3>
                    <div
                        class="connection-status disconnected"
                        id="connection-status"
                    >
                        <span>Disconnected</span>
                    </div>
                </div>

                <div class="key-display">
                    <div class="key-group">
                        <div class="key-button" id="key-w">W</div>
                        <div class="key-label">Sail Out</div>
                    </div>

                    <div>
                        <div class="d-flex gap-2">
                            <div class="key-group">
                                <div class="key-button" id="key-a">A</div>
                                <div class="key-label">Rudder Left</div>
                            </div>
                            <div class="key-group">
                                <div class="key-button" id="key-s">S</div>
                                <div class="key-label">Sail In</div>
                            </div>
                            <div class="key-group">
                                <div class="key-button" id="key-d">D</div>
                                <div class="key-label">Rudder Right</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="key-group mt-3">
                        <div class="key-button" id="key-p" style="width: 120px;">P</div>
                        <div class="key-label">Send Sail</div>
                    </div>
                </div>
            </div>

            <div class="boat-visualization mb-4">
                <h4 class="mb-3">Boat Visualization</h4>
                <div class="canvas-container">
                    <canvas id="boat-canvas" width="400" height="400"></canvas>
                    <div class="wind-info">
                        <span class="wind-label">Wind: </span>
                        <span class="wind-value" id="wind-angle">--</span>
                    </div>
                </div>
            </div>

            <div class="angle-display">
                <h4 class="mb-3">Current Angles</h4>

                <div class="angle-item">
                    <span class="angle-label">Rudder Angle:</span>
                    <span class="angle-value" id="rudder-angle">0.0°</span>
                </div>
                <div class="angle-bar">
                    <div
                        class="angle-bar-fill"
                        id="rudder-bar"
                        style="left: 50%; width: 0%"
                    ></div>
                    <div class="angle-bar-center"></div>
                </div>

                <div class="angle-item mt-4">
                    <span class="angle-label">Sail Angle:</span>
                    <span class="angle-value" id="sail-angle">0.0°</span>
                </div>
                <div class="angle-bar">
                    <div
                        class="angle-bar-fill"
                        id="sail-bar"
                        style="left: 0%; width: 0%"
                    ></div>
                </div>
            </div>

            <div class="status-panel">
                <h4 class="mb-3">Status</h4>
                <div class="status-item">
                    <span>Command Queue:</span>
                    <span>
                        <span id="queue-status">Idle</span>
                        <span
                            class="queue-indicator"
                            id="queue-indicator"
                        ></span>
                    </span>
                </div>
                <div class="status-item">
                    <span>Send Interval:</span>
                    <span>
                        <input 
                            type="number" 
                            id="send-interval-input" 
                            min="0.5" 
                            max="10" 
                            step="0.5" 
                            value="2.0"
                            class="interval-input"
                        />
                        <span class="interval-unit">seconds</span>
                    </span>
                </div>
                <div class="status-item">
                    <span>Next Send:</span>
                    <span class="send-timer" id="send-timer">2.0s</span>
                </div>
                <div class="status-item">
                    <span>Last Sent:</span>
                    <span id="last-sent">Never</span>
                </div>
            </div>

            <div class="instructions">
                <h4>Instructions</h4>
                <p>Use W/S keys to control the sail angle (0° to 88°)</p>
                <p>Use A/D keys to control the rudder angle (-20° to +20°)</p>
                <p>Press P to send sail angle command</p>
                <p>
                    Rudder commands are sent automatically at the specified interval
                </p>
            </div>
        </div>

        <script src="rc-renderer.js"></script>
    </body>
</html>
